name: seqtk
description: seqtk
options: []
subcommands:
  - name: seq
    usage: seqtk seq [options] <in.fq>|<in.fa>
    description: common transformation of FASTA/Q
    options:
      - names:
          - -X
        argument: INT
        description: mask bases with quality higher than INT [255]
      - names:
          - -n
        argument: CHAR
        description: masked bases converted to CHAR; 0 for lowercase [0]
      - names:
          - -l
        argument: INT
        description: number of residues per line; 0 for 2^32-1 [0]
      - names:
          - -Q
        argument: INT
        description: 'quality shift: ASCII-INT gives base quality [33]'
      - names:
          - -s
        argument: INT
        description: random seed (effective with -f) [11]
      - names:
          - -f
        argument: FLOAT
        description: sample FLOAT fraction of sequences [1]
      - names:
          - -M
        argument: FILE
        description: mask regions in BED or name list FILE [null]
      - names:
          - -L
        argument: INT
        description: drop sequences with length shorter than INT [0]
      - names:
          - -F
        argument: CHAR
        description: fake FASTQ quality []
      - names:
          - -c
        argument: ""
        description: mask complement region (effective with -M)
      - names:
          - -r
        argument: ""
        description: reverse complement
      - names:
          - -A
        argument: ""
        description: force FASTA output (discard quality)
      - names:
          - -C
        argument: ""
        description: drop comments at the header lines
      - names:
          - -N
        argument: ""
        description: drop sequences containing ambiguous bases
      - names:
          - "-1"
        argument: ""
        description: output the 2n-1 reads only
      - names:
          - "-2"
        argument: ""
        description: output the 2n reads only
      - names:
          - -V
        argument: ""
        description: shift quality by '(-Q) - 33'
      - names:
          - -U
        argument: ""
        description: convert all bases to uppercases
      - names:
          - -S
        argument: ""
        description: strip of white spaces in sequences
  - name: comp
    usage: seqtk comp [-u] [-r in.bed] <in.fa>
    description: get the nucleotide composition of FASTA/Q
    options:
      - names:
          - -u
        argument: ""
        description: Upper only
      - names:
          - -r
        argument: file
        description: Specify input BED file
  - name: sample
    usage: seqtk sample [-2] [-s seed=11] <in.fa> <frac>|<number>
    description: subsample sequences
    options:
      - names:
          - -s
        argument: INT
        description: RNG seed [11]
      - names:
          - "-2"
        argument: ""
        description: '2-pass mode: twice as slow but with much reduced memory'
  - name: subseq
    usage: seqtk subseq [options] <in.fa> <in.bed>|<name.list>
    description: extract subsequences from FASTA/Q
    options:
      - names:
          - -t
        argument: ""
        description: TAB delimited output
      - names:
          - -l
        argument: INT
        description: sequence line length [0]
  - name: fqchk
    usage: seqtk fqchk [-q 20] <in.fq>
    description: fastq QC (base/quality summary)
    options:
      - names:
          - -q
        argument: INT
        description: Quality value. Set 0 to get the distribution of all quality values.
  - name: mergepe
    usage: seqtk mergepe <in1.fq> <in2.fq>
    description: interleave two PE FASTA/Q files
    options: []
  - name: trimfq
    usage: seqtk trimfq [options] <in.fq>
    description: trim FASTQ using the Phred algorithm
    options:
      - names:
          - -q
        argument: FLOAT
        description: error rate threshold (disabled by -b/-e) [0.05]
      - names:
          - -l
        argument: INT
        description: maximally trim down to INT bp (disabled by -b/-e) [30]
      - names:
          - -b
        argument: INT
        description: trim INT bp from left (non-zero to disable -q/-l) [0]
      - names:
          - -e
        argument: INT
        description: trim INT bp from right (non-zero to disable -q/-l) [0]
      - names:
          - -L
        argument: INT
        description: retain at most INT bp from the 5'-end (non-zero to disable -q/-l) [0]
      - names:
          - -Q
        argument: ""
        description: force FASTQ output
  - name: hety
    usage: seqtk hety [options] <in.fa>
    description: regional heterozygosity
    options:
      - names:
          - -w
        argument: INT
        description: window size [50000]
      - names:
          - -t
        argument: INT
        description: '# start positions in a window [5]'
      - names:
          - -m
        argument: ""
        description: treat lowercases as masked
  - name: gc
    usage: seqtk gc [options] <in.fa>
    description: identify high- or low-GC regions
    options:
      - names:
          - -w
        argument: ""
        description: identify high-AT regions
      - names:
          - -f
        argument: FLOAT
        description: min GC fraction (or AT fraction for -w) [0.60]
      - names:
          - -l
        argument: INT
        description: min region length to output [20]
      - names:
          - -x
        argument: FLOAT
        description: X-dropoff [10.0]
  - name: mutfa
    usage: seqtk mutfa <in.fa> <in.snp>
    description: point mutate FASTA at specified positions
    options: []
  - name: mergefa
    usage: seqtk mergefa [options] <in1.fa> <in2.fa>
    description: merge two FASTA/Q files
    options:
      - names:
          - -q
        argument: INT
        description: quality threshold [0]
      - names:
          - -i
        argument: ""
        description: take intersection
      - names:
          - -m
        argument: ""
        description: convert to lowercase when one of the input base is N
      - names:
          - -r
        argument: ""
        description: pick a random allele from het
      - names:
          - -h
        argument: ""
        description: suppress hets in the input
  - name: famask
    usage: seqtk famask <src.fa> <mask.fa>
    description: apply a X-coded FASTA to a source FASTA
    options: []
  - name: dropse
    usage: seqtk dropse <in.fq>
    description: drop unpaired from interleaved PE FASTA/Q
    options: []
  - name: rename
    usage: seqtk rename <in.fq> [prefix]
    description: rename sequence names
    options: []
  - name: randbase
    usage: seqtk randbase <in.fa>
    description: choose a random base from hets
    options: []
  - name: cutN
    usage: seqtk cutN [options] <in.fa>
    description: cut sequence at long N
    options:
      - names:
          - -n
        argument: INT
        description: min size of N tract [1000]
      - names:
          - -p
        argument: INT
        description: penalty for a non-N [10]
      - names:
          - -g
        argument: ""
        description: print gaps only, no sequence
  - name: listhet
    usage: seqtk listhet <in.fa>
    description: extract the position of each het
    options: []
version: 1.3-r106
tldr: |
  > Toolkit for processing sequences in FASTA/Q formats
  > More information <https://github.com/lh3/seqtk>

  - Convert FASTQ to FASTA:

  `seqtk seq -a {{in.fq.gz}} > {{out.fa}}`

  - Convert ILLUMINA 1.3+ FASTQ to FASTA and mask bases with quality lower than 20 to lowercases:

  `seqtk seq -aQ64 -q20 {{in.fq}} > {{out.fa}}`

  - Fold long FASTA/Q lines and remove FASTA/Q comments:

  `seqtk seq -Cl60 {{in.fa}} > {{out.fa}}`

  - Convert multi-line FASTQ to 4-line FASTQ:

  `seqtk seq -l0 {{in.fq}} > {{out.fq}}`

  - Reverse complement FASTA/Q:

  `seqtk seq -r {{in.fq}} > {{out.fq}}`

  - Extract sequences with names in file name.lst, one sequence name per line:

  `seqtk subseq {{in.fq}} name.lst > {{out.fq}}`

  - Extract sequences in regions contained in file reg.bed:

  `seqtk subseq {{in.fa}} reg.bed > {{out.fa}}`

  - Mask regions in reg.bed to lowercases:

  `seqtk seq -M reg.bed {{in.fa}} > {{out.fa}}`

  - Subsample 10000 read pairs from two large paired FASTQ files:

  `seqtk sample -s100 read1.fq 10000 > sub1.fq`

  - Trim low-quality bases from both ends using the Phred algorithm:

  `seqtk trimfq {{in.fq}} > {{out.fq}}`

  - Trim 5bp from the left end of each read and 10bp from the right end:

  `seqtk trimfq -b 5 -e 10 {{in.fa}} > {{out.fa}}`

